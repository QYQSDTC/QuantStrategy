# 股票评分查询工具

## 功能介绍

这是一个专门用于查询特定股票在特定日期的**缩量十字星反转策略评分**的工具。你只需要提供股票名称（或代码）和日期，就能获得该股票在那一天的详细评分报告。

## 文件说明

- `stock_score_query.py` - 主查询工具
- `example_usage.py` - 使用示例脚本
- `backetest.py` - 原始回测策略文件

## 使用方法

### 方法 1: 命令行直接使用

```bash
# 使用股票名称查询
python stock_score_query.py --stock "大众交通" --date "2023-07-08"

# 使用股票代码查询
python stock_score_query.py --code "600611" --date "2023-07-08"

# 更多示例
python stock_score_query.py --stock "贵州茅台" --date "2023-06-15"
python stock_score_query.py --code "000001" --date "2023-08-20"
```

### 方法 2: 运行示例脚本

```bash
python example_usage.py
```

这将运行多个示例查询，展示工具的使用方法。

## 参数说明

| 参数      | 说明                        | 示例                         |
| --------- | --------------------------- | ---------------------------- |
| `--stock` | 股票名称（支持模糊匹配）    | "大众交通", "茅台", "平安"   |
| `--code`  | 股票代码（6 位数字）        | "600611", "600519", "000001" |
| `--date`  | 查询日期（YYYY-MM-DD 格式） | "2023-07-08"                 |

**注意**: `--stock` 和 `--code` 二选一即可。

## 输出报告说明

查询工具会输出详细的评分报告，包括：

### 1. 总评分

- **> 100 分**: ✅ 符合买入条件
- **> 85 分**: ⚠️ 接近买入条件
- **≤ 85 分**: ❌ 不符合买入条件

### 2. 分项评分明细

- **十字星质量**: 最高 35 分（实体大小+影线长度）
- **缩量程度**: 最高 20 分（成交量相对 20 日均量）
- **反转强度**: 最高 20 分（确认日收盘 vs 十字星最高）
- **技术面加分**: 最高 100 分（均线位置+DEA+确认日涨幅+放量确认等）

### 3. 关键数据

- 实体大小百分比
- 缩量比例
- 反转幅度
- 确认日涨幅
- 上下影线长度
- KDJ J 值等

### 4. 条件检查

- ✅ 满足的条件
- ❌ 未满足的条件
- 得分原因详细说明

## 策略逻辑说明

这个工具基于**缩量十字星反转策略**，核心逻辑如下：

### 分析日期设定

- **十字星日**: 目标日期前两天（形成十字星）
- **确认日**: 目标日期前一天（确认反转）
- **策略执行日**: 目标日期（评分日期）

### 评分标准

#### 十字星质量评分（最高 35 分）

- 实体大小 < 0.5%: +20 分
- 实体大小 < 1.0%: +15 分
- 明显上下影线: +15 分
- 有上下影线: +10 分

#### 缩量程度评分（最高 20 分）

- 缩量比例 < 0.5: +20 分（大幅缩量）
- 缩量比例 < 0.8: +15 分（明显缩量）
- 缩量比例 < 1.0: +10 分（缩量）

#### 反转强度评分（最高 20 分）

- 反转幅度 > 3%: +20 分（强势反转）
- 反转幅度 > 1%: +15 分（有效反转）
- 反转幅度 > 0%: +10 分（反转确认）

#### 技术面加分（最高 100 分）

- 开盘价低于 30 日线: +20 分（低位启动）
- 开盘价低于 20 日线: +10 分
- 收盘价高于 30 日线: +10 分（突破确认）
- 收盘价高于 20 日线: +20 分
- 均线多头排列(5>20>30): +20 分
- DEA 增大且满足条件: +10-15 分
- 确认日涨幅>5%: +10 分
- 确认日涨幅>9%: +20 分
- 确认日放量>6 倍: +10 分（大幅放量确认）

## 使用示例

### 示例 1: 查询大众交通

```bash
python stock_score_query.py --stock "大众交通" --date "2023-07-08"
```

### 示例 2: 查询贵州茅台

```bash
python stock_score_query.py --code "600519" --date "2023-06-15"
```

## 注意事项

1. **数据要求**: 查询日期前需要有足够的历史数据（至少 100 天）
2. **交易日检查**: 确保查询的是交易日，非交易日无数据
3. **网络要求**: 需要网络连接获取实时股票数据
4. **依赖包**: 确保已安装 `akshare`, `talib`, `pandas` 等依赖

## 安装依赖

```bash
pip install akshare talib pandas matplotlib
```

## 常见问题

**Q: 提示"未找到股票"怎么办？**
A: 检查股票名称是否正确，或尝试使用股票代码查询。

**Q: 提示"目标日期不在数据范围内"怎么办？**
A: 检查日期格式是否正确，或选择其他交易日。

**Q: 查询很慢怎么办？**
A: 首次查询需要获取股票列表和历史数据，请耐心等待。

## 技术支持

如有问题，请检查：

1. 网络连接是否正常
2. 依赖包是否正确安装
3. 日期格式是否为 YYYY-MM-DD
4. 股票名称或代码是否正确
